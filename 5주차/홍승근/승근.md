## 1.상황

> 이제 막 성장 하기 시작한 모바일 앱 푸시 알림 시스템 이며 현재 시스템은 매우 단순한 구조를 가지고 있습니다.

- 알림 생성 요청은 하루 평균 5백만 건에 도달 할 것으로 예상 됩니다. 
- 사용자 액션이 발생 시 서비스 API 서버가 직접 제3자 푸시 서비스(APNS 또는 FCM)에 동기적(synchronous)으로 알림 전송을 요청합니다 (이 설계는 단일 실패 지점(SPOF)이 될 수 있습니다).
- 최근 사용자가 늘어나면서 푸시 서비스 업체와의 통신 지연이 발생할 때마다, 사용자 요청을 처리하는 API 서버 전체가 느려지는(blocking) 현상이 발생했습니다.  이로 인해 사용자 경험이 저하되고 있습니다.

--------------------------------------------------------------------------------
## 2. 문제

- 위의 API 서버 병목 현상(bottleneck) 문제를 해결하고, 알림 시스템의 **확장성과 안정성**을 확보하기 위한 개선 방안을 제시해 주세요 

<img width="1088" height="524" alt="Image" src="https://github.com/user-attachments/assets/8cdaf84d-4842-446f-a8b1-b5c3c0d6b63a" />

## 1. 문제 원인
- 현재 알림 시스템은 단일 서버 구조로 구성되어 있으며, API 서버가 푸시 전송과 결과 확인을 동기적으로 처리하고 있음
- 트래픽이 몰릴 경우 서버 과부하가 발생할 수 있고, FCM/APNS 등 외부 푸시 서비스에 장애나 지연이 발생하면 전체 시스템이 영향을 받아 다운될 수 있음
- 근본적인 문제 원인
    1. 단일 서버 구조: 모든 처리를 하나의 서버에서 담당 → SPOF 발생 가능
    2. 동기 처리 방식: 외부 지연 시 API 서버 블록 → 병목 발생

## 2. 해결 방안
- 비동기 처리 도입
  - API 서버는 사용자 요청을 받아 즉시 메시지 큐에 알림 요청을 발행하고 응답
  - 큐에 쌓인 메시지는 작업 서버가 알림 서버와 독립적으로 메시지 큐에서 가져와FCM/APNS로 전송
  - 완화/해결 효과
    - API 서버 블로킹 문제 해소 → 병목 현상 완화
    - 외부 푸시 서비스 지연 시에도 사용자 요청 처리 지연 최소화
- 확장성과 안정성 확보
  - 메시지 큐 클러스터링, 작업 서버 수평 확장 → 트래픽 증가 대응
  - 전송률 제한, 재시도, 로그 기록, DLQ 적용 → 데이터 손실 방지 및 실패 메시지 관리
  - 큐 모니터링, 이벤트 추적 → 시스템 상태 확인
