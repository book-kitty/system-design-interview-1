***

## 시스템 구조




<img width="2185" height="1121" alt="image" src="https://github.com/user-attachments/assets/924df341-e3c4-4739-b184-fcea577e5f74" />


***

## 문제점

1. 동기처리
   - 푸시 알림 처리까지 대기해야 하는 블로킹이 발생되어 서버자원은 여유가 있어도 스레드가 점유되는 문제점 발생

2. 단일 실패 지점(SPOF)
   - 알림 서비스가 하나 밖에 없어서 서버 장애 발생 시에 전체 서비스 이용에 어려움 존재 

3. 시스템을 사용하는 유저 증가 시, 푸시 알림 발생 과정에서 병목 현상 발생
   - 서버가 증설되어도 동기 방식으로 푸시 알림이 발생되기에 병목 현상은 여전히 존재

4. 전송이 실패한 알림에 대해 추적 및 재시도 불가 
   - 서버에 일시적으로 장애가 발생하여, 발생되어야 할 알림 이벤트가 동작되지 않는다면 시스템 이용 불편 증가 및 신뢰도 하락

***

## 해결방안

[카프카]
- 관심 항목별로 독립적인 메시지 큐를 생성하여 알림을 유형별로 비동기 처리함으로써 서버 부하 최소화

[서버 다중화]
- 로드밸런서를 통해 알림 시스템 서버를 다중화하여 특정 서버 장애 발생 시, 무중단 서비스 보장을 통해 단일 실패 지점(SPOF) 제거
- 병목 현상 발생 시, 구축해둔 관심 항목별 작업 서버를 증설하여 서버 과부화 상황에 대처 가능

[푸시알림 재시도]
- 네트워크 불안정 혹은 기능 장애 발생으로 인해 실패한 알림에 대하여 재시도 큐에 메시지를 관리함으로써, 데이터 손실 방지

[레디스]
- 알림 발생을 위한 정보를 캐싱하여 처리 속도 극대화가 주 목적이다. 
- 사용자 설정 정보(시스템 내 푸시 알림 기능을 허용한 유저인지, sms 수신 동의한 유저인지, 알림 발생 허용 시간 정보 등..) 관리
- 알림 중복 방지 (푸시 알림 발생 시, 레디스 내 알림 ID 저장 후 보낸적 있는 알림이라면 무시 목적)
- 서버 자원 효율적 사용(ttl 설정을 통해 주기적으로 DB 값 갱신)

